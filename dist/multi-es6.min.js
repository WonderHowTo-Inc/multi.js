/*! multi.js 12-11-2023 */

var multi=function(){var e=function(e,t){var a=t.limit;if(a>-1){for(var n=0,i=0;i<e.options.length;i++)e.options[i].selected&&n++;if(n===a){this.disabled_limit=!0,"function"==typeof t.limit_reached&&t.limit_reached();for(i=0;i<e.options.length;i++){(d=e.options[i]).selected||d.setAttribute("disabled",!0)}}else if(this.disabled_limit){for(i=0;i<e.options.length;i++){var d;"false"===(d=e.options[i]).getAttribute("data-origin-disabled")&&d.removeAttribute("disabled")}this.disabled_limit=!1}}},t=function(t,a,n){var i,d,l,r=t.options[a.target.getAttribute("multi-index")];r.disabled||(r.selected=!r.selected,e(t,n),i="change",d=t,(l=document.createEvent("HTMLEvents")).initEvent(i,!1,!0),d.dispatchEvent(l))},a=function(e,t){if(e.wrapper.selected.innerHTML="",e.wrapper.non_selected.innerHTML="",t.non_selected_header&&t.selected_header){var a=document.createElement("div"),n=document.createElement("div");a.className="header",n.className="header",a.innerText=t.non_selected_header,n.innerText=t.selected_header,e.wrapper.non_selected.appendChild(a),e.wrapper.selected.appendChild(n)}if(e.wrapper.search)var i=e.wrapper.search.value;var d=null,l=null;if(t.hide_duplicate_selected_options)var r={};for(var s=0;s<e.options.length;s++){var o=e.options[s],c=o.value,p=o.textContent||o.innerText,u=document.createElement("a");if(u.tabIndex=0,u.className="item",u.innerText=p,u.setAttribute("role","button"),u.setAttribute("data-value",c),u.setAttribute("multi-index",s),o.disabled&&(u.className+=" disabled"),o.selected){u.className+=" selected";var h=u.cloneNode(!0);t.hide_duplicate_selected_options?r[c]||(e.wrapper.selected.appendChild(h),r[c]=!0):e.wrapper.selected.appendChild(h)}if("OPTGROUP"==o.parentNode.nodeName&&o.parentNode!=l){if(l=o.parentNode,(d=document.createElement("div")).className="item-group",o.parentNode.label){var m=document.createElement("span");m.innerHTML=o.parentNode.label,m.className="group-label",d.appendChild(m)}e.wrapper.non_selected.appendChild(d)}o.parentNode==e&&(d=null,l=null),(!i||i&&p.toLowerCase().indexOf(i.toLowerCase())>-1)&&(null!=d?d.appendChild(u):e.wrapper.non_selected.appendChild(u))}if(t.hide_empty_groups){var _=document.getElementsByClassName("item-group");for(s=0;s<_.length;s++)_[s].childElementCount<2&&(_[s].style.display="none")}};return function(n,i){if((i=void 0!==i?i:{}).enable_search=void 0===i.enable_search||i.enable_search,i.search_placeholder=void 0!==i.search_placeholder?i.search_placeholder:"Search...",i.non_selected_header=void 0!==i.non_selected_header?i.non_selected_header:null,i.selected_header=void 0!==i.selected_header?i.selected_header:null,i.limit=void 0!==i.limit?parseInt(i.limit):-1,isNaN(i.limit)&&(i.limit=-1),i.hide_empty_groups=void 0!==i.hide_empty_groups&&i.hide_empty_groups,i.hide_duplicate_selected_options=void 0!==i.hide_duplicate_selected_options&&i.hide_duplicate_selected_options,null==n.dataset.multijs&&"SELECT"==n.nodeName&&n.multiple){n.style.display="none",n.setAttribute("data-multijs",!0);var d=document.createElement("div");if(d.className="multi-wrapper",i.enable_search){var l=document.createElement("input");l.className="search-input",l.type="text",l.setAttribute("placeholder",i.search_placeholder),l.setAttribute("title",i.search_placeholder),l.addEventListener("input",function(){a(n,i)}),d.appendChild(l),d.search=l}var r=document.createElement("div");r.className="non-selected-wrapper";var s=document.createElement("div");s.className="selected-wrapper",d.addEventListener("click",function(e){e.target.getAttribute("multi-index")&&t(n,e,i)}),d.addEventListener("keypress",function(e){var a=32===e.keyCode||13===e.keyCode;e.target.getAttribute("multi-index")&&a&&(e.preventDefault(),t(n,e,i))}),d.appendChild(r),d.appendChild(s),d.non_selected=r,d.selected=s,n.wrapper=d,n.parentNode.insertBefore(d,n.nextSibling);for(var o=0;o<n.options.length;o++){var c=n.options[o];c.setAttribute("data-origin-disabled",c.disabled)}e(n,i),a(n,i),n.addEventListener("change",function(){a(n,i)})}}}();"undefined"!=typeof jQuery&&function(e){e.fn.multi=function(t){return t=void 0!==t?t:{},this.each(function(){var a=e(this);multi(a.get(0),t)})}}(jQuery);export default multi;