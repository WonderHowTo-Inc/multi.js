/*! multi.js 12-11-2023 */

var multi=function(){var e=function(e,t){var i=t.limit;if(i>-1){for(var n=0,a=0;a<e.options.length;a++)e.options[a].selected&&n++;if(n===i){this.disabled_limit=!0,"function"==typeof t.limit_reached&&t.limit_reached();for(a=0;a<e.options.length;a++){(d=e.options[a]).selected||d.setAttribute("disabled",!0)}}else if(this.disabled_limit){for(a=0;a<e.options.length;a++){var d;"false"===(d=e.options[a]).getAttribute("data-origin-disabled")&&d.removeAttribute("disabled")}this.disabled_limit=!1}}},t=function(t,i,n){var a,d,l,r,s=t.options[i.target.getAttribute("multi-index")];s.disabled||(s.selected=!s.selected,e(t,n),a="change",d=t,l=s,(r=document.createEvent("HTMLEvents")).initEvent(a,!1,!0),r.causedBy=l,d.dispatchEvent(r))},i=function(e,t){if(e.wrapper.selected.innerHTML="",e.wrapper.non_selected.innerHTML="",t.non_selected_header&&t.selected_header){var i=document.createElement("div"),n=document.createElement("div");i.className="header",n.className="header",i.innerText=t.non_selected_header,n.innerText=t.selected_header,e.wrapper.non_selected.appendChild(i),e.wrapper.selected.appendChild(n)}if(e.wrapper.search)var a=e.wrapper.search.value;var d=null,l=null;if(t.hide_duplicate_selected_options)var r={};for(var s=0;s<e.options.length;s++){var o=e.options[s],c=o.value,p=o.textContent||o.innerText,u=document.createElement("a");if(u.tabIndex=0,u.className="item",u.innerText=p,u.setAttribute("role","button"),u.setAttribute("data-value",c),u.setAttribute("multi-index",s),o.disabled&&(u.className+=" disabled"),o.selected){u.className+=" selected";var h=u.cloneNode(!0);t.hide_duplicate_selected_options?r[c]||(e.wrapper.selected.appendChild(h),r[c]=!0):e.wrapper.selected.appendChild(h)}if("OPTGROUP"==o.parentNode.nodeName&&o.parentNode!=l){if(l=o.parentNode,(d=document.createElement("div")).className="item-group",o.parentNode.label){var m=document.createElement("span");m.innerHTML=o.parentNode.label,m.className="group-label",d.appendChild(m)}e.wrapper.non_selected.appendChild(d)}o.parentNode==e&&(d=null,l=null),(!a||a&&p.toLowerCase().indexOf(a.toLowerCase())>-1)&&(null!=d?d.appendChild(u):e.wrapper.non_selected.appendChild(u))}if(t.hide_empty_groups){var _=document.getElementsByClassName("item-group");for(s=0;s<_.length;s++)_[s].childElementCount<2&&(_[s].style.display="none")}};return function(n,a){if((a=void 0!==a?a:{}).enable_search=void 0===a.enable_search||a.enable_search,a.search_placeholder=void 0!==a.search_placeholder?a.search_placeholder:"Search...",a.non_selected_header=void 0!==a.non_selected_header?a.non_selected_header:null,a.selected_header=void 0!==a.selected_header?a.selected_header:null,a.limit=void 0!==a.limit?parseInt(a.limit):-1,isNaN(a.limit)&&(a.limit=-1),a.hide_empty_groups=void 0!==a.hide_empty_groups&&a.hide_empty_groups,a.hide_duplicate_selected_options=void 0!==a.hide_duplicate_selected_options&&a.hide_duplicate_selected_options,null==n.dataset.multijs&&"SELECT"==n.nodeName&&n.multiple){n.style.display="none",n.setAttribute("data-multijs",!0);var d=document.createElement("div");if(d.className="multi-wrapper",a.enable_search){var l=document.createElement("input");l.className="search-input",l.type="text",l.setAttribute("placeholder",a.search_placeholder),l.setAttribute("title",a.search_placeholder),l.addEventListener("input",function(){i(n,a)}),d.appendChild(l),d.search=l}var r=document.createElement("div");r.className="non-selected-wrapper";var s=document.createElement("div");s.className="selected-wrapper",d.addEventListener("click",function(e){e.target.getAttribute("multi-index")&&t(n,e,a)}),d.addEventListener("keypress",function(e){var i=32===e.keyCode||13===e.keyCode;e.target.getAttribute("multi-index")&&i&&(e.preventDefault(),t(n,e,a))}),d.appendChild(r),d.appendChild(s),d.non_selected=r,d.selected=s,n.wrapper=d,n.parentNode.insertBefore(d,n.nextSibling);for(var o=0;o<n.options.length;o++){var c=n.options[o];c.setAttribute("data-origin-disabled",c.disabled)}e(n,a),i(n,a),n.addEventListener("change",function(e){!function(e,t,n){n.hide_duplicate_selected_options,i(t,n)}(0,n,a)})}}}();"undefined"!=typeof jQuery&&function(e){e.fn.multi=function(t){return t=void 0!==t?t:{},this.each(function(){var i=e(this);multi(i.get(0),t)})}}(jQuery);export default multi;