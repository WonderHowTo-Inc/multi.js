/*! multi.js 12-11-2023 */

var multi=function(){var e=function(e,t){var a=t.limit;if(a>-1){for(var n=0,d=0;d<e.options.length;d++)e.options[d].selected&&n++;if(n===a){this.disabled_limit=!0,"function"==typeof t.limit_reached&&t.limit_reached();for(d=0;d<e.options.length;d++){(i=e.options[d]).selected||i.setAttribute("disabled",!0)}}else if(this.disabled_limit){for(d=0;d<e.options.length;d++){var i;"false"===(i=e.options[d]).getAttribute("data-origin-disabled")&&i.removeAttribute("disabled")}this.disabled_limit=!1}}},t=function(t,a,n){var d,i,l,r,s=t.options[a.target.getAttribute("multi-index")];s.disabled||(s.selected=!s.selected,e(t,n),d="change",i=t,l=s,(r=document.createEvent("HTMLEvents")).initEvent(d,!1,!0),r.causedBy=l,i.dispatchEvent(r))},a=function(e,t){if(e.wrapper.selected.innerHTML="",e.wrapper.non_selected.innerHTML="",t.non_selected_header&&t.selected_header){var a=document.createElement("div"),n=document.createElement("div");a.className="header",n.className="header",a.innerText=t.non_selected_header,n.innerText=t.selected_header,e.wrapper.non_selected.appendChild(a),e.wrapper.selected.appendChild(n)}if(e.wrapper.search)var d=e.wrapper.search.value;var i=null,l=null;if(t.deduplicate_selected_options)var r={};for(var s=0;s<e.options.length;s++){var o=e.options[s],c=o.value,p=o.textContent||o.innerText,u=document.createElement("a");if(u.tabIndex=0,u.className="item",u.innerText=p,u.setAttribute("role","button"),u.setAttribute("data-value",c),u.setAttribute("multi-index",s),o.disabled&&(u.className+=" disabled"),o.selected){u.className+=" selected";var h=u.cloneNode(!0);t.deduplicate_selected_options?r[c]||(e.wrapper.selected.appendChild(h),r[c]=!0):e.wrapper.selected.appendChild(h)}if("OPTGROUP"==o.parentNode.nodeName&&o.parentNode!=l){if(l=o.parentNode,(i=document.createElement("div")).className="item-group",o.parentNode.label){var m=document.createElement("span");m.innerHTML=o.parentNode.label,m.className="group-label",i.appendChild(m)}e.wrapper.non_selected.appendChild(i)}o.parentNode==e&&(i=null,l=null),(!d||d&&p.toLowerCase().indexOf(d.toLowerCase())>-1)&&(null!=i?i.appendChild(u):e.wrapper.non_selected.appendChild(u))}if(t.hide_empty_groups){var _=document.getElementsByClassName("item-group");for(s=0;s<_.length;s++)_[s].childElementCount<2&&(_[s].style.display="none")}};return function(n,d){if((d=void 0!==d?d:{}).enable_search=void 0===d.enable_search||d.enable_search,d.search_placeholder=void 0!==d.search_placeholder?d.search_placeholder:"Search...",d.non_selected_header=void 0!==d.non_selected_header?d.non_selected_header:null,d.selected_header=void 0!==d.selected_header?d.selected_header:null,d.limit=void 0!==d.limit?parseInt(d.limit):-1,isNaN(d.limit)&&(d.limit=-1),d.hide_empty_groups=void 0!==d.hide_empty_groups&&d.hide_empty_groups,d.deduplicate_selected_options=void 0!==d.deduplicate_selected_options&&d.deduplicate_selected_options,null==n.dataset.multijs&&"SELECT"==n.nodeName&&n.multiple){n.style.display="none",n.setAttribute("data-multijs",!0);var i=document.createElement("div");if(i.className="multi-wrapper",d.enable_search){var l=document.createElement("input");l.className="search-input",l.type="text",l.setAttribute("placeholder",d.search_placeholder),l.setAttribute("title",d.search_placeholder),l.addEventListener("input",function(){a(n,d)}),i.appendChild(l),i.search=l}var r=document.createElement("div");r.className="non-selected-wrapper";var s=document.createElement("div");s.className="selected-wrapper",i.addEventListener("click",function(e){e.target.getAttribute("multi-index")&&t(n,e,d)}),i.addEventListener("keypress",function(e){var a=32===e.keyCode||13===e.keyCode;e.target.getAttribute("multi-index")&&a&&(e.preventDefault(),t(n,e,d))}),i.appendChild(r),i.appendChild(s),i.non_selected=r,i.selected=s,n.wrapper=i,n.parentNode.insertBefore(i,n.nextSibling);for(var o=0;o<n.options.length;o++){var c=n.options[o];c.setAttribute("data-origin-disabled",c.disabled)}e(n,d),a(n,d),n.addEventListener("change",function(e){!function(e,t,n){n.deduplicate_selected_options&&t.querySelectorAll(`option[value="${e.causedBy.value}"]`).forEach(function(t){t.selected=e.causedBy.selected}),a(t,n)}(e,n,d)})}}}();"undefined"!=typeof jQuery&&function(e){e.fn.multi=function(t){return t=void 0!==t?t:{},this.each(function(){var a=e(this);multi(a.get(0),t)})}}(jQuery);